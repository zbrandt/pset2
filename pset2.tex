\documentclass{article}\usepackage[]{graphicx}\usepackage[]{xcolor}
% maxwidth is the original width if it is less than linewidth
% otherwise use linewidth (to make sure the graphics do not exceed the margin)
\makeatletter
\def\maxwidth{ %
  \ifdim\Gin@nat@width>\linewidth
    \linewidth
  \else
    \Gin@nat@width
  \fi
}
\makeatother

\definecolor{fgcolor}{rgb}{0.345, 0.345, 0.345}
\newcommand{\hlnum}[1]{\textcolor[rgb]{0.686,0.059,0.569}{#1}}%
\newcommand{\hlstr}[1]{\textcolor[rgb]{0.192,0.494,0.8}{#1}}%
\newcommand{\hlcom}[1]{\textcolor[rgb]{0.678,0.584,0.686}{\textit{#1}}}%
\newcommand{\hlopt}[1]{\textcolor[rgb]{0,0,0}{#1}}%
\newcommand{\hlstd}[1]{\textcolor[rgb]{0.345,0.345,0.345}{#1}}%
\newcommand{\hlkwa}[1]{\textcolor[rgb]{0.161,0.373,0.58}{\textbf{#1}}}%
\newcommand{\hlkwb}[1]{\textcolor[rgb]{0.69,0.353,0.396}{#1}}%
\newcommand{\hlkwc}[1]{\textcolor[rgb]{0.333,0.667,0.333}{#1}}%
\newcommand{\hlkwd}[1]{\textcolor[rgb]{0.737,0.353,0.396}{\textbf{#1}}}%
\let\hlipl\hlkwb

\usepackage{framed}
\makeatletter
\newenvironment{kframe}{%
 \def\at@end@of@kframe{}%
 \ifinner\ifhmode%
  \def\at@end@of@kframe{\end{minipage}}%
  \begin{minipage}{\columnwidth}%
 \fi\fi%
 \def\FrameCommand##1{\hskip\@totalleftmargin \hskip-\fboxsep
 \colorbox{shadecolor}{##1}\hskip-\fboxsep
     % There is no \\@totalrightmargin, so:
     \hskip-\linewidth \hskip-\@totalleftmargin \hskip\columnwidth}%
 \MakeFramed {\advance\hsize-\width
   \@totalleftmargin\z@ \linewidth\hsize
   \@setminipage}}%
 {\par\unskip\endMakeFramed%
 \at@end@of@kframe}
\makeatother

\definecolor{shadecolor}{rgb}{.97, .97, .97}
\definecolor{messagecolor}{rgb}{0, 0, 0}
\definecolor{warningcolor}{rgb}{1, 0, 1}
\definecolor{errorcolor}{rgb}{1, 0, 0}
\newenvironment{knitrout}{}{} % an empty environment to be redefined in TeX

\usepackage{alltt}

\usepackage{fancyhdr}
\usepackage{extramarks}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage{tikz}
\usepackage[plain]{algorithm}
\usepackage{algpseudocode}
\usepackage{enumitem}
\usepackage{tikz-cd}


\usetikzlibrary{automata,positioning}

%
% Basic Document Settings
%

\topmargin=-0.45in
\evensidemargin=0in
\oddsidemargin=0in
\textwidth=6.5in
\textheight=9.0in
\headsep=0.25in

\linespread{1.1}

\pagestyle{fancy}
\lhead{\hmwkAuthorName}
\chead{\hmwkClass\ (\hmwkClassInstructor\ \hmwkClassTime): \hmwkTitle}
\rhead{\firstxmark}
\lfoot{\lastxmark}
\cfoot{\thepage}

\renewcommand\headrulewidth{0.4pt}
\renewcommand\footrulewidth{0.4pt}

\setlength\parindent{0pt}

%
% Create Problem Sections
%

\newcommand{\enterProblemHeader}[1]{
    \nobreak\extramarks{}{Question \arabic{#1} continued on next page\ldots}\nobreak{}
    \nobreak\extramarks{Question \arabic{#1}}{Question \arabic{#1} continued on next page\ldots}\nobreak{}
}

\newcommand{\exitProblemHeader}[1]{
    \nobreak\extramarks{Question \arabic{#1}}{Question \arabic{#1} continued on next page\ldots}\nobreak{}
    \stepcounter{#1}
    \nobreak\extramarks{Question \arabic{#1}}{}\nobreak{}
}


\newcommand{\enterCode}[1]{
    \nobreak\extramarks{}{Code continued on next page\ldots}\nobreak{}
    \nobreak\extramarks{Code continued on next page\ldots}\nobreak{}
}

\newcommand{\exitCode}[1]{
    \nobreak\extramarks{Code continued on next page\ldots}\nobreak{}
    \stepcounter{#1}
    \nobreak\extramarks{Code \arabic{#1}}{}\nobreak{}
}

\setcounter{secnumdepth}{0}
\newcounter{partCounter}
\newcounter{homeworkProblemCounter}
\setcounter{homeworkProblemCounter}{1}
\nobreak\extramarks{Question \arabic{homeworkProblemCounter}}{}\nobreak{}

%
% Homework Problem Environment
%
% This environment takes an optional argument. When given, it will adjust the
% problem counter. This is useful for when the problems given for your
% assignment aren't sequential. See the last 3 problems of this template for an
% example.
%
\newenvironment{homeworkProblem}[1][-1]{
    \ifnum#1>0
        \setcounter{homeworkProblemCounter}{#1}
    \fi
    \section{Question \arabic{homeworkProblemCounter}}
    \setcounter{partCounter}{1}
    \enterProblemHeader{homeworkProblemCounter}
}{
    \exitProblemHeader{homeworkProblemCounter}
}


%
% Homework Details
%   - Title
%   - Due date
%   - Class
%   - Section/Time
%   - Instructor
%   - Author
%

\newcommand{\hmwkTitle}{Problem Set\ \#2}
\newcommand{\hmwkDueDate}{April 5, 2024}
\newcommand{\hmwkClass}{Econometrics}
\newcommand{\hmwkClassTime}{Section 101}
\newcommand{\hmwkClassInstructor}{Professor Ben Faber}
\newcommand{\hmwkAuthorName}{\textbf{Zachary Brandt}}

%
% Title Page
%

\title{
    \vspace{2in}
    \textmd{\textbf{\hmwkClass:\ \hmwkTitle}}\\
    \normalsize\vspace{0.1in}\small{Due\ on\ \hmwkDueDate\ at 4:00pm}\\
    \vspace{0.1in}\large{\textit{\hmwkClassInstructor\ \hmwkClassTime}}
    \vspace{3in}
}

\author{\hmwkAuthorName}
\date{}

\renewcommand{\part}[1]{\textbf{\large Part \Alph{partCounter}}\stepcounter{partCounter}\\}

%
% Various Helper Commands
%

% Useful for algorithms
\newcommand{\alg}[1]{\textsc{\bfseries \footnotesize #1}}

% For derivatives
\newcommand{\deriv}[1]{\frac{\mathrm{d}}{\mathrm{d}x} (#1)}

% For partial derivatives
\newcommand{\pderiv}[2]{\frac{\partial}{\partial #1} (#2)}

% Integral dx
\newcommand{\dx}{\mathrm{d}x}

% Alias for the Solution section header
\newcommand{\solution}{\textbf{\large Solution}}

% Probability commands: Expectation, Variance, Covariance, Bias
\newcommand{\E}{\mathrm{E}}
\newcommand{\Var}{\mathrm{Var}}
\newcommand{\Cov}{\mathrm{Cov}}
\newcommand{\Bias}{\mathrm{Bias}}
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\begin{document}

\maketitle

\pagebreak

\begin{homeworkProblem}

    The Ministry of Commerce in a large country wants to know the causal effect of membership in a
    local Chamber of Commerce on firm revenues and profits. Firms pay for their membership and they
    supposedly benefit from the network of information and contacts that the local Chambers of
    Commerce offer them. But usually, it is only a small minority of all firms that end up paying for the
    membership. \newline

    The Ministry plans to estimate the causal effect of being a member in a local Chamber of Commerce
    by letting the Ministry’s staff estimate the average percentage change in annual firm sales between
    firms that are members and the rest of the firms that are non-members of their local Chamber of
    Commerce. 

    \begin{enumerate}
        \item[A)] Write down the OLS regression specification that the Ministry’s staff could use to implement their analysis described above. Interpret what the intercept and slope coefficients would capture in such a specification.
        \item[B)] Using notation from the Potential Outcomes Framework, briefly explain the concept of the Average Treatment Effect (ATE) to the Minister, and how what they plan to estimate in A) relates to this definition.
        \item[C)] Referring to the expressions you use in your answer to B), explain why a randomized control trial (RCT) could be useful, and very briefly describe the basics of the RCT design for how the Ministry could set this up.
        \item[D)] The Ministry mentions that it has no legal authority to force firms to become members in their local Chambers of Commerce. Using notation from the Potential Outcomes Framework, explain why this information could be important for the interpretation of the results from the RCT relative to the ATE, and how the Ministry should address this concern in the RCT analysis?
        \item[E)] The Ministry talked to other economists, and now it is worried about spillover effects on the control group. The staff don’t fully understand what the concern is, however. Briefly explain to them the intuition behind this concern, and explain how they could potentially address it when designing the RCT.
    \end{enumerate}
    
    \pagebreak

    \part

    Write down the OLS regression specification that the Ministry’s staff could use to implement their analysis described above. Interpret what the intercept and slope coefficients would capture in such a specification.
    \\
    
    \solution  

    The following OLS regression specification is one that the Ministry could implement:

    \[ 
        ln(Y_i) = \beta_0 + \beta_1 D_i + u_i 
    \]
    
    where
        \begin{itemize}[label={}, itemsep=0pt]
            \item the subscript $i$ runs over the observations, $i = 1,\dots,n$;
            \item $Y_i$ is the \textit{dependent variable}, annual firm sales 
            \item $D_i$ is the \textit{dummy variable}, $D_i=1$ if the firm is a local Chamber of Commerce member and $0$ otherwise 
            \item $\beta_0$ is the \textit{intercept} of the regression, the population mean value of annual, non-member firm sales 
            \item $\beta_1$ is the coefficient on $D_i$, associating a change in $D_i$ by one unit with a $100 \times \beta_1\%$ change in $Y_i$
            \item $\beta_0 + \beta_1$ is the population mean value of annual, member firm sales
            \item $u_i$ is the \textit{error} term, all the factors responsiblze for the difference between predicted and observed values
        \end{itemize}

    \pagebreak


    \part
    
    Using notation from the Potential Outcomes Framework, briefly explain the concept of the Average Treatment Effect (ATE) to the Minister, and how what they plan to estimate in A) relates to this definition.
    \\

    \solution
    
    One core challenge with evaluating the causal effect of membership in a local Chamber of Commerce on firm revenues and profits is that we cannot observe a firm $i$ in two different states of the world: one where the firm is a member, and one where it is not. Instead, we can compare the mean outcomes of two firm groups (members vs. non-members) to learn about the true, average treatment effect (ATE) of membership using our regression specification in part A).  \\
    \\
    The ATE is defined as:
    \[
        ATE = E(Y_i(1) - Y_i(0))
    \]
    where $Y_i(1)$ represents the potential outcome (the annual sales) of a firm $i$ if part of a local Chamber of Commerce and $Y_i(0)$ represents the annual sales for the \textbf{same} firm if not. \\
    \\
    To compare the mean outcomes of the two groups of firms (members vs. non-members of a local Chamber of Commerce), we instead estimate:
    \[
        E(Y_i(1) \:|\: X_i = 1) - E(Y_i(0) \:|\: X_i = 0)  
    \]
    where we condition our observation of $Y_i$ on $X_i$, with $X_i = 1$ representing if firm $i$ is part of a local Chamber of Commerce, and $X_i = 0$ if it is not. The above is not necessarily equal to the ATE defined earlier because $X_i$, or membership status, is \textit{not independent} of potential outcomes (annual firm sales). We would have to show first that, in the absence of a local Chamber of Commerce, member and non-member firms would have to be on average identical (there would have to be no selection bias).\\
    \\
    Unpacking the above expression we can see the effect of selection bias:
    \[
        \begin{split}
            E(Y_i(1) \:|\: D_i = 1) - E(Y_i(0) \:|\: D_i = 1) &= \underbrace{E(Y_i(1) \:|\: D_i = 1) - E(Y_i(0) \:|\: D_i = 1)}_\text{Average Treatment Effect on the Treated}
            \\
            &+ \underbrace{E(Y_i(0) \:|\: D_i = 1) - E(Y_i(0) \:|\: D_i = 0)}_\text{Selection Bias} 
        \end{split}
    \]
    The first term is the average treatment effect on the treated (ATT), the difference between $Y_i(1)$ and $Y_i(0)$ for the group of firms that are members of a local Chamber of Commerce. 
    The second term estimates the selection bias by comparing $Y_i(0)$, annual sales before being a member, between members, $X_i = 1$, and non-members, $X_i = 0$. $E(Y_i(0) \:|\: X_i = 1)$ cannot be observed directly for both of these terms, because we cannot rerun the experiment a second time where the treatment is not applied.
    The bias term appears because firms that are members of a local Chamber of Commerce may have different outcomes than firms that are not members, \textit{even in the absence of a local Chamber of Commerce}.
    
    \pagebreak

    \part 
    
    Referring to the expressions you use in your answer to B), explain why a randomized control trial (RCT) could be useful, and very briefly describe the basics of the RCT design for how the Ministry could set this up.
    \\

    \solution

    In a RCT, treatment and control groups are randomly selected, and the average outcomes of these two groups are compared after the treatment. By randomly allocating treatment status, we can use the simple difference in outcomes between treatment and control groups to estimate the ATE. This is because the randomization removes selection bias by ensuring that member firms and non-member firms are comparable in terms of both observable and unobservable characteristics and that any difference between the two groups is not due to systematic differences. This implies that the ATE = ATT. \\
    \\
    Connecting back to the potential outcomes framework in part B) and our regression from part A), $D_i = 1$ indicates if firm $i$ is a member of a local Chamber of Commerce (the treatment), and $D_i = 0$ if the firm is not ($D_i$ indicates treatment status). $Y_i(1)$ are the annual sales (the potential outcome) for a firm $i$ if treated (part of a local Chamber or Commerce), and $Y_i(0)$ are the annual sales for the same firm if not. \\
    \\
    The ATE is then defined as:
    \[
        \begin{split}
            ATE &= E(Y_i(1) - Y_i(0))
        \end{split}
    \]
    
    If the treatment assignment $D_i$ is assigned randomly and independent of the potential outcomes of the firms ($D_i\perp (Y_i(1), Y_i(0))$), we can compare the mean outcomes of the two groups (members vs. non-members of a local Chamber of Commerce):
    \[
        \begin{split}
            E(Y_i(1) \:|\: D_i = 1) - E(Y_i(0) \:|\: D_i = 1) &= \underbrace{E(Y_i(1) \:|\: D_i = 1) - E(Y_i(0) \:|\: D_i = 1)}_\text{Average Treatment Effect on the Treated}
            \\
            &+ \underbrace{E(Y_i(0) \:|\: D_i = 1) - E(Y_i(0) \:|\: D_i = 0)}_\text{Selection Bias} 
            \\
            &= E(Y_i(1) \:|\: D_i = 1) - E(Y_i(0) \:|\: D_i = 1) \: \: \: \text{(selection bias is zero)}
            \\
            &= ATT
        \end{split}
    \]
    because the treatment status is independent of outcomes, we can also show: 
    \[
        \begin{split}
            ATT &= E(Y_i(1) - Y_i(0)) = ATE
        \end{split}
    \]


    This means that if we randomly assign treatment status (membership in a local Chamber of Commerce) and control status (non-membership), we can estimate the ATE by comparing mean sales outcomes across the two groups of observation. An experimenter would have to randomly select from a sample of firms which ones to assign to the control group and become or remain non-members of a local Chamber of Commerce and assign the others to remain or become members of a local Chamber of Commerce. After a certain period, the experimenter will conclude the experiment and record sales data and assignment status for each firm in the study.\\
    
    We can report the estimated treatment effect of the RCT design from the OLS regression, $ln(Y_i) = \beta_0 + \beta_1 D_i + u_i$. The $\beta_1$ coefficient is the difference in means between the treatment group relative to the control group. Dividing this difference by its standard error produces a $t$-statistic that allows us to determine whether the observed difference in annual sales between firms part of a local Chamber of Commerce and firms that are not is statistically significant. 
    \pagebreak

    \part 
    
    The Ministry mentions that it has no legal authority to force firms to become members in their local Chambers of Commerce. Using notation from the Potential Outcomes Framework, explain why this information could be important for the interpretation of the results from the RCT relative to the ATE, and how the Ministry should address this concern in the RCT analysis?
    \\

    \solution

    In the case where assigned treatment status, $D_i$, cannot be enforced on firms, $T_i$ represents the effective treatment status of a firm $i$. Some firms may not comply with their assigned treatment status: firms assigned to become members of a local Chamber of Commerce may opt not to, and firms assigned to be non-members might become members. However, firms' choices to deviate from their assigned treatment are not random, and $T_i$ may be correlated with annual sales (potential outcomes). $T_i\perp (Y_i(0), Y_i(1))$ is no longer true, which means the difference between the mean outcomes of the control and treatment groups may be influenced by selection bias. \\
    \\
    However, the initial assignment status, $D_i$, is still randomly assigned and may have strong predictive power on actual treatment status, $T_i$. So, to address our original concern, we can use $D_i$ as an instrumental variable for $T_i$ to estimate the causal effect. Using an instrumental variable will limit the variation in the effective treatment status, $T_i$, to only the part that can be predicted by the randomly assigned $D_i$. This will pick out only the exogneous variation of the independent variable $T_i$ to deal with concerns of bias in the case where there is only partial compliance. To be a valid instrumental variable, $D_i$ must satisfy three conditions: instrument relevance, instrument exogeneity, and the instrument exclusion restriction. \\
    \\
    \textit{Instrument relevance.} The instrument needs to be related strongly enough with the endogenous, explantory variables of interest $T_i$. So, as long as the assignment protocol is partially followed, then the actual treatment status will be partially determined by the assigned treatment status, making $D_i$ a relevant instrumental variable. \\
    \\
    \textit{Instrument exogenity.} The instrument must be uncorrelated with any observed variables that also affect $Y_i$ in the error term. That is, $Cor(D_i, u_i) = 0$. Since initial treatment assignment is random, then $D_i$ is distributed independently of $u_i$, so the instrument is exogenous. \\
    \\
    \textit{Instrument exclusion restriction.} The instrument must not have a direct effect on $Y_i$ except through its relationship with $T_i$. That is, conditional on $T_i$, $D_i$ has no effect on $Y_i$. Again, since the initial treatment assignment is random, $D_i$ is distributed independenty of any other variable than $T_i$ that can have an effect on $Y_i$, satisfying the exclusion restriction. \\
    \\
    Therefore, the original random treatment assignment is a valid instrumental variable, and the following is the two-stage least squares regression:
    \[
        \begin{split}
            T_i &= \beta_0' + \beta_1'D_i + u_i' \: \: \: \text{(first stage)}
            \\
            ln(Y_i) &= \beta_0 + \beta_1 \widehat{T_i} + u_i \: \: \: \: \text{(second stage)}
            \\
            ln(Y_i) &= \beta_0'' + \beta_1''D_i+u_i'' \: \text{(reduced form)}
        \end{split}
    \]

    In contrast to our original regression, our point estimate from the second stage is a weighted average of the treatment effect $\beta_{1i}$, where the weights increase with the degree to which the instrument $D_i$ influences $T_i$ in the first stage. This is because the treatment effect from the instrumental variables regression gives greater weights to units that respond to the instrument in the first place:
    \[
        \begin{split}
            \widehat{\beta_{IV}} = \frac{\beta_1''}{\beta_1'} = \frac{E(Y_i | D_i = 1 - Y_i | D_i = 0)}{E(T_i | D_i = 1 - T_i | D_i = 0)} = \frac{\text{Intent-to-treat effect (ITT)}}{\text{Difference in fraction treated between groups}} = LATE
        \end{split}  
    \]

    That is, instead of estimating the average treatment effect, or ATE, we instead estimate the local average treatment effect (LATE) after isolating the variation in $T_i$ to the group of compliers. This is because we don't know if the firms that complied are representative to the whole sample of firms chosen for the experiment and is why the causal effect in the instrumental variable case is a local average. So, when we adjust for less than full compliance in our RCT by instrumenting the effect treatment status with assigned treatment status, our point estimate, $\widehat{\beta_{IV}}$, reflects a ratio between an ``intent-to-treat" effect (ITT), the difference in mean outcomes between members and non-members of a local Chamber of Commerce, and the proportion of compliers, producing the LATE. \\
    \\
    The average treatment effect on the treat (ATT) is then the same thing as the LATE: the causal effect of being a member of a local Chamber of Commerce estimated on the group of firms that chose to take up the experiment when offered to them. This is different from the ATE because it was not randomized which firms will actually follow adhere to their assigned treatment status. It's instead an independent decision made by each firm. In a rational world, the ATT will usually demonstrate a stronger effect than the ATE because the firms that take up the treatment probably have more to gain.
    
    \pagebreak

    \part

    The Ministry talked to other economists, and now it is worried about spillover effects on the control group. The staff don’t fully understand what the concern is, however. Briefly explain to them the intuition behind this concern, and explain how they could potentially address it when designing the RCT.
    \\

    \solution

    The concern behind spillover effects is that, even if we were to isolate the treatment (membership in a local Chamber of Commerce) to firms only in the treatment group and restrict membership for those in the control group, we still have to worry about the effects that the treatment has on the control group. For example, in the case where membership in a local Chamber of Commerce improves firm sales for members, increased sales may contribute to overall economic surplus and increas sales for firms in the control group. This means that the control group is no longer a reference in which nothing has changed. \\
    \\
    One solution would be to seperate treatment and control group in some way so that the effect of nearby firms assigned to the treatment group affecting the outcomes of firms assigned to the control group by the end of the period. For example, if the true causal effect of being a member of a local Chamber of Commerce is positive, that is $\beta_1$ reflects a positive slope for $D_i$, these firms may experience increased annual sales. If that is the case, a better business environment may in some way stimulate demand so that non-member, control-group firms may now also see higher sales. Or the opposite: firms part of a local Chamber of Commerce might corner the market and non-member firms might experience greater losses than they otherwise would have. I have identified two different ways below an experimenter may seperate treatment and control group firms so as to mitigate spillover effects. \\
    
    \textit{Geographical seperation.} Assuming the treatment (assignment to a local Chamber of Commerce) has a non-zero effect on economic activity, segregating treatment and control groups to different locations may isolate the ``ripple effects'' of the different economic activity of members of a local Chamber of Commerce to a confined area, or at least make these effects neglible to the mean outcomes of non-member firms. For example, firms in the city of Portland, Oregon are assigned to join a local Chamber of Commerce, and the firms of Atlanta, Georgia constitute the control group. The economic consequences of firms in Portland now members of a local Chamber of Commerce may not be felt all the way in Atlanta. There is the problem of confounding variables however, in that, something about the treatment group's location may affect how they interact with the treatment. In this case, an experimenter may want to increase the sample size to reduce the effects of selection bias. \\

    \textit{Industry stratification.} Instead of, or in conjunction with, geographical seperation of treatment and control groups, it may be prudent to assign firms to treatment and control groups on an industry-wide level. For example, firms engaged in the fishing industry might be assigned to become members of a local Chamber of Commerce, whereas home furniture firms may not. In the case where the treatment increases fishing firm sales, this might have no effect on a very inelastic market for home furnishings. The same type of problem identified in the above method is relevant with this stratification method. There might be something inherent to fishing industry firms that affects the way they interact with the treatment that might not be representative of all firms. That is, there might be selection bias. In this case, an experimenter would need to select a wide variety of industries in both the treatment and control groups to ``average out'' the effects of this bias.
    

\end{homeworkProblem}

\pagebreak

\begin{homeworkProblem}

    To answer this question, we will use R and the dataset ``Mexico\_PS2.csv" that you can download from bCourses. The dataset contains 1153 Mexican municipalities that reported some amount of local tourism activity (measured by local hotel sales) in the year 2000. Write up the answers below in the same document as above. In addition, also attach the complete code that you used to answer the questions. You are not required to export results in LaTeX, it is enough to show your output in R (using either knitR/RMarkdown or just showing the output, e.g. with screenshots).
    
    \begin{enumerate}
        \item[A)] Visualize a table that lists the number of observations, the mean, the standard deviation, the minimum value and the maximum value for each of the variables in the dataset (if you had difficulties with this in the previous problem set, use the summary() command). Briefly describe what we learn from the table about the sample of Mexican municipalities.
        \item[B)] Use the data to obtain an OLS point estimate of the effect of the average years of education on the logarithm of local average monthly household incomes. Show your result in a regression table, using the command stargazer(). Comment on the interpretation and statistical significance of your results.
        \item[C)] List three plausible arguments why the point estimate in b) could be biased upwards or downwards relative to the true causal effect of education on monthly household incomes. Be specific in signing the bias for each argument.
        \item[D)] Now your GSI suggests that the natural logarithm of kilometer distance between the center of the municipality and the nearest segment of the US-Mexico border could be a valid instrumental variable for the average years of education in a municipality (because incentives for education are higher in regions exporting to the US). List the assumptions that need to hold true for this to be correct.
        \item[E)] Verify if the assumption of instrument relevance is satisfied, and export the results into the same regression table that you used above (again using the stargazer() command). Comment on the interpretation and statistical significance of your result.
        \item[F)] Now estimate the 2\textsuperscript{nd} stage IV (TSLS) point estimate as suggested by your GSI, and show your result in the same regression table you used before (again using the stargazer() command). Comment on the interpretation and statistical significance of your result. In reference to your answer to c), is the difference between the OLS and IV point estimates as you expected or rather not? 
        \item[G)] Now one of your friends suggests that the distance to the US border is likely correlated with other local characteristics that affect local incomes, such as the logarithm of local tourism sales, the logarithm of the average temperature, the logarithm of the average precipitation, and the proportion of indigenous population. Estimate the first-stage regression and the reduced-form regression both before and after you add those variables as additional controls in the two regressions (estimating 4 regression specifications in total). Export your regression results in a new regression table. Comment on the results and what they imply about the validity of the instrumental variable strategy. 
    \end{enumerate}
    
    \pagebreak

    \part

    Visualize a table that lists the number of observations, the mean, the standard deviation, the minimum value and the maximum value for each of the variables in the dataset (if you had difficulties with this in the previous problem set, use the summary() command). Briefly describe what we learn from the table about the sample of Mexican municipalities.
    \\

    \solution

    \begin{table}[!htbp] \centering 
        % \caption{} 
        \label{} 
      \begin{tabular}{@{\extracolsep{5pt}}lccccc} 
        \\[-1.8ex]\hline 
        \hline \\[-1.8ex] 
            Statistic & \multicolumn{1}{c}{N} & \multicolumn{1}{c}{Mean} & \multicolumn{1}{c}{St. Dev.} & \multicolumn{1}{c}{Min} & \multicolumn{1}{c}{Max} \\ 
        \hline \\[-1.8ex] 
            year & 1,153 & 2,000.000 & 0.000 & 2,000 & 2,000 \\ 
            municode & 1,153 & 18,168.720 & 8,045.480 & 1,001 & 32,056 \\ 
            inc\_m & 1,153 & 2,583.081 & 1,257.101 & 299.757 & 14,792.910 \\ 
            ind\_lang & 1,153 & 0.114 & 0.221 & 0.000 & 0.984 \\ 
            educ\_years & 1,153 & 7.031 & 1.354 & 2.488 & 11.870 \\ 
            sales\_hotel & 1,153 & 27,120.140 & 201,033.400 & 1 & 5,229,616 \\ 
            logtemp & 1,153 & 5.283 & 0.212 & 4.658 & 5.671 \\ 
            logprecip & 1,153 & 4.304 & 0.562 & 1.790 & 5.746 \\ 
            dist\_us\_km & 1,153 & 696.171 & 278.301 & 6.609 & 1,348.003 \\ 
        \hline \\[-1.8ex] 
      \end{tabular} 
    \end{table} 

    From the table, the sample of Mexican municipalities includes 1,153 units of observation. All units were recorded in the year 2000, as the year statistic has no variation across observations in the sample. The units of observation are Mexican municipalities, which, besides the year statistic, also record the municipality code (municode), average monthly income (inc\_m), the proportion of the indigenous population (ind\_lang), average years of education (educ\_years), local hotel sales (sales\_hotel), the logarith of the average temperature (logtemp), the logarithm of the average precipitation (logprecip), and the distance to the US border (dist\_us\_km). \\
    \\
    \textit{Average monthly income.} Average monthly incomes have a low mean value and a relatively large standard devation. The distribution could be right skewed as the mean is far closer to the minimum value than the maximum value. \\
    \\
    \textit{Proportion of the indigenous population.} The mean value for the indigenous proportion of Mexican municipalities population stands at 11.4\%. However, the standard devation is very high, suggesting a broad distribution of proportions. Some municipalities have effectively 0\% and some are near 100\%. \\
    \\
    \textit{Average years of education.} In contrast to the aformentioned statistics, the variation in average years of educational attainment is smaller, suggesting a tighter distribution. Most observations have statistics close to the sample mean, with few outliers. \\
    \\
    \textit{Local hotel sales.} Local hotel sales vary massively. Many municipalities record neglible sales. The distribution appears to be right skewed with a long tail towards higher sales. \\
    
    \pagebreak

    \part 

    Use the data to obtain an OLS point estimate of the effect of the average years of education on the logarithm of local average monthly household incomes. Show your result in a regression table, using the command stargazer(). Comment on the interpretation and statistical significance of your results.
    \\

    \solution

    \begin{table}[!htbp] \centering 
        % \caption{} 
        \label{} 
      \begin{tabular}{@{\extracolsep{5pt}}lc} 
        \\[-1.8ex]\hline 
        \hline \\[-1.8ex] 
        & \multicolumn{1}{c}{\textit{Dependent variable:}} \\ 
        \cline{2-2} 
        \\[-1.8ex] & log(inc\_m) \\ 
        \hline \\[-1.8ex] 
        educ\_years & 0.183$^{***}$ \\ 
            & (0.007) \\ 
            & \\ 
        Constant & 6.485$^{***}$ \\ 
            & (0.047) \\ 
            & \\ 
            \hline \\[-1.8ex] 
                Observations & 1,153 \\ 
                R$^{2}$ & 0.400 \\ 
                Adjusted R$^{2}$ & 0.399 \\ 
                Residual Std. Error & 0.304 (df = 1151) \\ 
                F Statistic & 767.224$^{***}$ (df = 1; 1151) \\ 
            \hline 
        \hline \\[-1.8ex] 
        \textit{Note:}  & \multicolumn{1}{r}{$^{*}$p$<$0.1; $^{**}$p$<$0.05; $^{***}$p$<$0.01} \\ 
      \end{tabular} 
    \end{table}
    
    The following OLS regression specification was applied to produce the results above:

    \[ 
        \widehat{ln(inc\_m_i)} = \widehat{\beta_0} + \widehat{\beta_1} \times educ\_years_i 
    \]
    
    where
        \begin{itemize}[label={}, itemsep=0pt]
            % \item the subscript $i$ runs over the Mexican municipalities, $i = 1,\dots,n$;
            % \item $Y_i$ is the \textit{dependent variable}, annual firm sales 
            % \item $D_i$ is the \textit{dummy variable}, $D_i=1$ if the firm is a local Chamber of Commerce member and $0$ otherwise 
            \item $\widehat{\beta_0}$ is the \textit{intercept} of the regression. This sample mean value of the logarithm of local average monthly household incomes is 6.485 when average years of education is 0. This result is statistically significant at the 0.01 level (*** corresponds to a p-val below the 1\% threshold). With a $t$-stat of $\frac{6.485}{0.047} = 137.979$ in magnitude, greater than the $t$-stat of 1.96 for a 5\% threshold to reject $H_0: \beta_0 = 0$, a confidence interval built with this standard error at the 5\% level does not contain zero.
            \item $\widehat{\beta_1}$ is the coefficient on $educ\_years_i$, associating a one year increase in the average years of education with an 18.3\% increase in local average monthly household incomes. This result is statistically significant at the 0.01 level (*** corresponds to a p-val below the 1\% threshold). With a $t$-stat of $\frac{0.183}{0.007} = 26.143$ in magnitude, greater than the $t$-stat of 1.96 for a 5\% threshold to reject $H_0: \beta_1 = 0$, a confidence interval built with this standard error at the 5\% level does not contain zero.
            \item The $R^{2}$ is 0.4, meaning 44\% of the variation in the logarithm of local average monthly incomes can be explained by this model.
            % \item $u_i$ is the \textit{error} term, all the factors responsiblze for the difference between predicted and observed values
        \end{itemize}
    
    \pagebreak

    \part 

    List three plausible arguments why the point estimate in b) could be biased upwards or downwards
    relative to the true causal effect of education on monthly household incomes. Be specific
    in signing the bias for each argument. 
    \\

    \solution 
    
    Below are three reasons why the point estimate $\widehat{\beta_1}$ from part B) may be biased relative to the true causal effect of education on incomes, $\beta_1$. \\
    \\
    \textbf{Omitted variable bias.} Below is the formula to identify the effects of omitted variable bias on our point estimate with $educ\_years$ as our variable of interest and $X$ as another variable currently in the error term: 

    \[
        \begin{split}
            \underbrace{\widehat{\beta_1}}_\text{Our point estimate} &= \underbrace{\beta_1}_\text{the true causal effect} + \underbrace{\beta_2 \times \frac{Cov(educ\_years, X)}{Var(educ\_years)}}_\text{OVB bias}
        \end{split}
    \]
    \\
    Monthly household incomes could be impacted by a host of other factors that could be correlated with education, such as ability or age. Ability might have a direct effect on household incomes and might also be positively correlated with education, with more able people tending to invest more into education and driving up the average years of education. As such the covariance between education and age would be positive, leading to a positive bias. Age might have a similar effect, with older people tending to have more years in education. Age might have an effect on incomes too, with more senior workers having higher incomes. Again, the covariance between these two variables would be positive. By not including these factors, age and ability, as variables in our regression, there is more undue weight given to education, overestimating the true causal effect $\beta_1$.
    \\

    \textbf{Measurement error.} Below is the formula to identify the effects of measurement error on the explanator variable, $educ\_years$, on our point estimate:
    
    \[
        \begin{split}
            \underbrace{\widehat{\beta_1}}_\text{Our point estimate} &= \underbrace{\beta_1'}_\text{the true causal effect} - \underbrace{\beta_1' \times \frac{Var(e))}{Var(educ\_years)}}_\text{ME bias}
        \end{split}
    \]
    \\
     is ``noise'' in measurements of the explanator variable of average years of education, $educ_years$ will be correlated with the error term. The effect of measurement error on the explanatory variable is to exert negative bias on the point estimate when the true effect of average years of education on local average monthly household incomes is positive and vice versa. That is, the $bias > 0$ when $\beta_1' < 0$ and $bias < 0$ when $\beta_1' > 0$. This make sense if the ``noise'' is not biased in any particular direction (that is, average years of education are generally overreported as much as they are underreported). In our case then, with a positive point estimate, the measurement error bias is negative.
    \\
    \\
    \textbf{Reverse causality bias.}
    
    \[
        \begin{tikzcd}
            educ\_years \arrow[r] & ln(inc\_m) \arrow[l]
        \end{tikzcd} 
    \] 

    One reason that there might be reverse causality bias at play is because wealthier people (measured in terms of local average monthly household incomes) might already pursue more education than those who don't. Thus there may be a positive bias from our dependent variable now explaining some of the variation in the explanatory variable.

    \pagebreak

    \part 

    Now your GSI suggests that the natural logarithm of kilometer distance between the center of the municipality and the nearest segment of the US-Mexico border could be a valid instrumental variable for the average years of education in a municipality (because incentives for education are higher in regions exporting to the US). List the assumptions that need to hold true for this to be correct.
    \\

    \solution 
    
    There are three assumptions that need to be true for a variable to be a valid instrument:

    \begin{enumerate}
        \item \textbf{Instrument relevance}: The potential instrument needs to be related strongly enough with the endogenous, explanatory variable. 
        \item \textbf{Instrument exogeneity}: The instrument must not be correlated with any other unobserved variables (in the error term) that affect the dependent variable. That is, $Cor(ln(dist\_us\_km), u) = 0$.
        \item \textbf{Instrument exclusion restriction}: The instrument must not have a direct effect on the dependent variable except throught its influence on the endogenous explanatory variable. That is, conditioning for $educ\_years$, $ln(dist\_us\_km)$ has no effect on $ln(inc\_m)$, so again $Cor(ln(dist\_us\_km), u) = 0$. 
    \end{enumerate}

    \pagebreak

    \part 

    Verify if the assumption of instrument relevance is satisfied, and export the results into the same regres- sion table that you used above (again using the stargazer() command). Comment on the interpretation and statistical significance of your result.
    \\

    \solution

    \begin{table}[!htbp] \centering 
        % \caption{} 
        \label{} 
      \begin{tabular}{@{\extracolsep{5pt}}lcc} 
      \\[-1.8ex]\hline 
      \hline \\[-1.8ex] 
       & \multicolumn{2}{c}{\textit{Dependent variable:}} \\ 
      \cline{2-3} 
      \\[-1.8ex] & log(inc\_m) & educ\_years \\ 
      \\[-1.8ex] & (1) & (2)\\ 
      \hline \\[-1.8ex] 
       educ\_years & 0.183$^{***}$ &  \\ 
        & (0.007) &  \\ 
        & & \\ 
       log(dist\_us\_km) &  & $-$0.424$^{***}$ \\ 
        &  & (0.052) \\ 
        & & \\ 
       Constant & 6.485$^{***}$ & 9.738$^{***}$ \\ 
        & (0.047) & (0.332) \\ 
        & & \\ 
      \hline \\[-1.8ex] 
      Observations & 1,153 & 1,153 \\ 
      R$^{2}$ & 0.400 & 0.055 \\ 
      Adjusted R$^{2}$ & 0.399 & 0.055 \\ 
      Residual Std. Error (df = 1151) & 0.304 & 1.317 \\ 
      F Statistic (df = 1; 1151) & 767.224$^{***}$ & 67.597$^{***}$ \\ 
      \hline 
      \hline \\[-1.8ex] 
      \textit{Note:}  & \multicolumn{2}{r}{$^{*}$p$<$0.1; $^{**}$p$<$0.05; $^{***}$p$<$0.01} \\ 
      \end{tabular} 
    \end{table} 

    The following first-stage regression specification was applied to produce the results for (2) above:

    \[ 
        \widehat{educ\_years_i} = \widehat{\beta_0} + \widehat{\beta_1} \times ln(dist\_us\_km_i) 
    \]
    
    where
        \begin{itemize}[label={}, itemsep=0pt]
            \item $\widehat{\beta_0}$ is the \textit{intercept} of the regression. This sample mean value of the average years of education is 9.738 when the distance to the US border is 0. This result is statistically significant at the 0.01 level (*** corresponds to a p-val below the 1\% threshold). With a $t$-stat of $\frac{9.738}{0.332} = 29.331d$ in magnitude, greater than the $t$-stat of 1.96 for a 5\% threshold to reject $H_0: \beta_0 = 0$, a confidence interval built with this standard error at the 5\% level does not contain zero.
            \item $\widehat{\beta_1}$ is the coefficient on $ln(dist\_us\_km)$, associating a one percent increase in the distance to the US border with 0.004 decrease in the average years of education. This result is statistically significant at the 0.01 level (*** corresponds to a p-val below the 1\% threshold). With a $t$-stat of $c{-0.424}{0.052} = -8.154$ in magnitude, greater than the $t$-stat of 1.96 for a 5\% threshold to reject $H_0: \beta_0 = 0$, a confidence interval built with this standard error at the 5\% level does not contain zero.
            \item The $F$-stat is 67.597, a result statistically significant at the 0.01 level and above 10, meaning $log(dist\_us\_km)$ is related strongly enough with $educ\_years$ to pass the instrument relevance test.
        \end{itemize}

    \pagebreak

    \part

    Now estimate the 2\textsuperscript{nd} stage IV (TSLS) point estimate as suggested by your GSI, and show your result in the same regression table you used before (again using the stargazer() command). Comment on the interpretation and statistical significance of your result. In reference to your answer to c), is the difference between the OLS and IV point estimates as you expected or rather not? 
    \\

    \solution

    \begin{table}[!htbp] \centering 
        % \caption{} 
        \label{} 
      \begin{tabular}{@{\extracolsep{5pt}}lccc} 
      \\[-1.8ex]\hline 
      \hline \\[-1.8ex] 
       & \multicolumn{3}{c}{\textit{Dependent variable:}} \\ 
      \cline{2-4} 
      \\[-1.8ex] & log(inc\_m) & educ\_years & log(inc\_m) \\ 
      \\[-1.8ex] & \textit{OLS} & \textit{OLS} & \textit{IV} \\ 
    %    & \textit{} & \textit{} & \textit{variable} \\ 
      \\[-1.8ex] & (1) & (2) & (3)\\ 
      \hline \\[-1.8ex] 
       educ\_years & 0.183$^{***}$ &  & 0.453$^{***}$ \\ 
        & (0.007) &  & (0.044) \\ 
        & & & \\ 
       log(dist\_us\_km) &  & $-$0.424$^{***}$ &  \\ 
        &  & (0.052) &  \\ 
        & & & \\ 
       Constant & 6.485$^{***}$ & 9.738$^{***}$ & 4.589$^{***}$ \\ 
        & (0.047) & (0.332) & (0.309) \\ 
        & & & \\ 
      \hline \\[-1.8ex] 
      Observations & 1,153 & 1,153 & 1,153 \\ 
      R$^{2}$ & 0.400 & 0.055 & $-$0.465 \\ 
      Adjusted R$^{2}$ & 0.399 & 0.055 & $-$0.466 \\ 
      Residual Std. Error (df = 1151) & 0.304 & 1.317 & 0.475 \\ 
      F Statistic (df = 1; 1151) & 767.224$^{***}$ & 67.597$^{***}$ &  \\ 
      \hline 
      \hline \\[-1.8ex] 
      \textit{Note:}  & \multicolumn{3}{r}{$^{*}$p$<$0.1; $^{**}$p$<$0.05; $^{***}$p$<$0.01} \\ 
      \end{tabular} 
    \end{table} 

    The following second-stage regression specification was applied to produce the results for (3) above:

    \[ 
        \widehat{ln(inc\_m_i)} = \widehat{\beta_0} + \widehat{\beta_1} \times \widehat{educ\_years_i} 
    \]
    
    where
        \begin{itemize}[label={}, itemsep=0pt]
            \item $\widehat{educ\_years_i}$ are the predicted values for the endogenous explanatory variable, average years of education, instrumented on distance to the US border in the first-stage model from (1).
            \item $\widehat{\beta_0}$ is the \textit{intercept} of the regression. This sample mean value of the logarithm of local average household income is 4.589 when the average years of education is 0. This result is statistically significant at the 0.01 level.
            \item $\widehat{\beta_1}$ is the coefficient on $educ\_years_i$, associating a one year increase in the average years of education with a 45.3\% increase in local average monthly household incomes. This result is statistically significant at the 0.01 level.
            % \item The $F$-stat is 67.597, a result statistically significant at the 0.01 level and above 10, meaning $log(dist\_us\_km)$ is related strongly enough with $educ\_years$ to pass the instrument relevance test.
        \end{itemize}
    
    The difference between the OLS and IV point estimates for $\beta_1$ was different that what I expected because in part C I identified three reasons why the OLS estimate might be the result of positive bias. However, the new IV point estimate suggests there was negative bias deflating the true value of $\beta_1$, or the effect of an extra year of average years of education on local average monthly incomes. 

    \pagebreak

    \part 

    Now one of your friends suggests that the distance to the US border is likely correlated with other local characteristics that affect local incomes, such as the logarithm of local tourism sales, the logarithm of the average temperature, the logarithm of the average precipitation, and the proportion of indigenous population. Estimate the first-stage regression and the reduced-form regression both before and after you add those variables as additional controls in the two regressions (estimating 4 regression specifications in total). Export your regression results in a new regression table. Comment on the results and what they imply about the validity of the instrumental variable strategy. 
    \\

    \solution

    \begin{table}[!htbp] \centering 
        % \caption{} 
        \label{} 
      \begin{tabular}{@{\extracolsep{-1 pt}}lcccc} 
        \\[-1.8ex]\hline 
        \hline \\[-1.8ex] 
        & \multicolumn{4}{c}{\textit{Dependent variable:}} \\ 
        \cline{2-5} 
        \\[-1.8ex] & \multicolumn{2}{c}{educ\_years} & \multicolumn{2}{c}{log(inc\_m)} \\ 
        \\[-1.8ex] & (1) & (2) & (3) & (4)\\ 
        \hline \\[-1.8ex] 
        log(dist\_us\_km) & $-$0.424$^{***}$ & $-$0.034 & $-$0.192$^{***}$ & $-$0.091$^{***}$ \\ 
            & (0.052) & (0.048) & (0.014) & (0.015) \\ 
            & & & & \\ 
        log(sales\_hotel) &  & 0.239$^{***}$ &  & 0.042$^{***}$ \\ 
            &  & (0.012) &  & (0.004) \\ 
            & & & & \\ 
        logtemp &  & $-$0.714$^{***}$ &  & $-$0.105$^{**}$ \\ 
            &  & (0.153) &  & (0.047) \\ 
            & & & & \\ 
        logprecip &  & $-$0.432$^{***}$ &  & $-$0.124$^{***}$ \\ 
            &  & (0.072) &  & (0.022) \\ 
            & & & & \\ 
        ind\_lang &  & $-$1.246$^{***}$ &  & $-$0.439$^{***}$ \\ 
            &  & (0.150) &  & (0.046) \\ 
            & & & & \\ 
        Constant & 9.738$^{***}$ & 11.537$^{***}$ & 9.000$^{***}$ & 9.233$^{***}$ \\ 
            & (0.332) & (0.787) & (0.092) & (0.241) \\ 
            & & & & \\ 
        \hline \\[-1.8ex] 
        Observations & 1,153 & 1,153 & 1,153 & 1,153 \\ 
        R$^{2}$ & 0.055 & 0.435 & 0.135 & 0.367 \\ 
        Adjusted R$^{2}$ & 0.055 & 0.433 & 0.135 & 0.365 \\ 
        Residual Std. Error & 1.317 (df = 1151) & 1.020 (df = 1147) & 0.365 (df = 1151) & 0.313 (df = 1147) \\ 
        F Statistic & 67.597$^{***}$ (df = 1) & 176.598$^{***}$ (df = 5) & 180.291$^{***}$ (df = 1) & 133.152$^{***}$ (df = 5) \\ 
        \hline 
        \hline \\[-1.8ex] 
        \textit{Note:}  & \multicolumn{4}{r}{$^{*}$p$<$0.1; $^{**}$p$<$0.05; $^{***}$p$<$0.01} \\ 
      \end{tabular} 
    \end{table} 

    The model that produced results for (1) was already described in part E). The following first-stage and reduced-form regression specifications were applied to produce the results for (2), (3), and (4):
    
    \[ 
        \begin{split}
            \text{(2)} \: \:\widehat{educ\_years_i} &= \widehat{\alpha_0} + \widehat{\alpha_1} \; ln(dist\_us\_km_i) + \widehat{\alpha_2} \; ln(sales\_hotel_i) + \widehat{\alpha_3} \;logtemp_i + \widehat{\alpha_4}\; logprecip_i + \widehat{\alpha_5}\; ind\_lang_i
            \\
            \text{(3)} \: \: \: \: \widehat{ln(inc\_m_i)} &= \widehat{\beta_0} + \widehat{\beta_1} \; ln(dist\_us\_km_i)
            \\
            \text{(4)} \: \: \: \: \widehat{ln(inc\_m_i)} &= \widehat{\gamma_0} + \widehat{\gamma_1} \; ln(dist\_us\_km_i) + \widehat{\gamma_2} \; ln(sales\_hotel_i) + \widehat{\gamma_3} \;logtemp_i + \widehat{\gamma_4}\; logprecip_i + \widehat{\gamma_5}\; ind\_lang_i
        \end{split}
    \]

    From the (2) first-stage regression of average years of education on the logarithm of distance to the US border alongside the additional control variables, the coefficent on $log(dist\_us\_km_i)$ is no longer statistically significant at either the 0.01, 0.05, or 0.1 levels in contrast to (1), the model without the control variables. This suggests that our instrumental variables strategy has a weak first stage, and our IV point estimate is unreliable. This unreliability in our IV point estimate might be validated for a skeptic when computing $\widehat{\beta_{IV}}$ as a ratio between the controlled first-stage point estimate and the controlled reduced-form point estimate:

    \[
        \frac{\widehat{\gamma_1}}{\widehat{\alpha_1}} = \frac{-0.091}{-0.034} = 2.676
    \]
        \\
    This is a relatively huge IV value and might be a symptom of having a weak instrument (it suggests that, conditioning for the other control variables, a one percent change in the distance to the US border corresponds to a 267.6\% change in local average monthly household incomes). Economic theory and real world experience point to this conclusion not being reliable.\\
    
    Even for regression (1) the instrument effect on education is quite miniscule (from part E), the point estimate relates a one percent change in the distance to the US border with a 0.004 unit decrease in the average years of education) and now with the controls in place it doesn't have a statistically significant effect at all.\\

    It's possible that our instrument also does not pass the instrument exclusion restriction. While the effect of the logarithm of distance to the US border might not be statistically significant, its effect on the logarithm of local average monthly household incomes is. In this case, our instrument does not have an affect on the dependent variable only through our endogenous explanatory variable but rather through other ways.
    
        \[
            \begin{tikzcd}
                Z \ar[r,"a"] \ar[rr,bend right,"c"'] & X \ar[r,"b"] & Y
            \end{tikzcd} 
        \] 
    \\
    For a potential instrumental variable to be a valid candidate, the effect it has on the dependent variable must only act through the explanatory one (through `a' and then `b' in the diagram above). If it impacts $Y$ through `c' for instance, it is not valid as the explanatory variable is no longer exogenous. In regression (4) we can see how, in contrast to (2), the point estimate for the causal effect of $ln(dist\_us\_km)$ on $ln(inc\_m)$ is statistically significant at the 0.01 level. That is, our point estimate for $\gamma_1$ is statistically significant.
    
    %   doesnt pass instrument exclusion restriction, affects income through other ways but not through education (statistically insignificant result for (2))



    
\end{homeworkProblem}

\pagebreak

\section*{\centering Code}
\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
    \hlcom{#install.packages(c("dplyr", "stargazer", "knitr", "ivreg"))}
    \hlkwd{library}\hlstd{(dplyr)}
    \hlkwd{library}\hlstd{(stargazer)}
    \hlkwd{library}\hlstd{(knitr)}
    \hlkwd{library}\hlstd{(ivreg)}

    \hlkwd{setwd}\hlstd{(}\hlkwd{paste}\hlstd{(}\hlstr{"/home/zachary/Desktop/ECON 140/Problem Set 2/code"}\hlstd{,} \hlkwc{sep}\hlstd{=}\hlstr{""}\hlstd{))}
    \hlstd{mexico} \hlkwb{<-} \hlkwd{read.csv}\hlstd{(}\hlstr{"Mexico_PS2.csv"}\hlstd{)}

    \hlcom{# part a}
    \hlkwd{stargazer}\hlstd{(mexico,} \hlkwc{type} \hlstd{=} \hlstr{"text"}\hlstd{)}
\end{alltt}
\begin{verbatim}
## 
## ===========================================================
## Statistic     N      Mean     St. Dev.     Min      Max    
## -----------------------------------------------------------
## year        1,153 2,000.000     0.000     2,000    2,000   
## municode    1,153 18,168.720  8,045.480   1,001    32,056  
## inc_m       1,153 2,583.081   1,257.101  299.757 14,792.910
## ind_lang    1,153   0.114       0.221     0.000    0.984   
## educ_years  1,153   7.031       1.354     2.488    11.870  
## sales_hotel 1,153 27,120.140 201,033.400    1    5,229,616 
## logtemp     1,153   5.283       0.212     4.658    5.671   
## logprecip   1,153   4.304       0.562     1.790    5.746   
## dist_us_km  1,153  696.171     278.301    6.609  1,348.003 
## -----------------------------------------------------------
\end{verbatim}
\begin{alltt}
    \hlcom{# part b}
    \hlstd{ols} \hlkwb{<-} \hlkwd{lm}\hlstd{(}\hlkwd{log}\hlstd{(inc_m)} \hlopt{~} \hlstd{educ_years, mexico)}
    \hlkwd{stargazer}\hlstd{(ols,} \hlkwc{type} \hlstd{=} \hlstr{"text"}\hlstd{)}
\end{alltt}
\begin{verbatim}
## 
## ===============================================
##                         Dependent variable:    
##                     ---------------------------
##                             log(inc_m)         
## -----------------------------------------------
## educ_years                   0.183***          
##                               (0.007)          
##                                                
## Constant                     6.485***          
##                               (0.047)          
##                                                
## -----------------------------------------------
## Observations                   1,153           
## R2                             0.400           
## Adjusted R2                    0.399           
## Residual Std. Error      0.304 (df = 1151)     
## F Statistic          767.224*** (df = 1; 1151) 
## ===============================================
## Note:               *p<0.1; **p<0.05; ***p<0.01
\end{verbatim}
\begin{alltt}
    \hlcom{# part e}
    \hlstd{first_stage} \hlkwb{<-} \hlkwd{lm}\hlstd{(educ_years} \hlopt{~} \hlkwd{log}\hlstd{(dist_us_km), mexico)}
    \hlkwd{stargazer}\hlstd{(ols, first_stage,} \hlkwc{type} \hlstd{=} \hlstr{"text"}\hlstd{)}
\end{alltt}
\begin{verbatim}
## 
## ============================================================
##                                     Dependent variable:     
##                                 ----------------------------
##                                   log(inc_m)    educ_years  
##                                      (1)            (2)     
## ------------------------------------------------------------
## educ_years                         0.183***                 
##                                    (0.007)                  
##                                                             
## log(dist_us_km)                                  -0.424***  
##                                                   (0.052)   
##                                                             
## Constant                           6.485***      9.738***   
##                                    (0.047)        (0.332)   
##                                                             
## ------------------------------------------------------------
## Observations                        1,153          1,153    
## R2                                  0.400          0.055    
## Adjusted R2                         0.399          0.055    
## Residual Std. Error (df = 1151)     0.304          1.317    
## F Statistic (df = 1; 1151)        767.224***     67.597***  
## ============================================================
## Note:                            *p<0.1; **p<0.05; ***p<0.01
\end{verbatim}
\begin{alltt}
    \hlcom{# part f}
    \hlstd{second_stage} \hlkwb{<-} \hlkwd{ivreg}\hlstd{(}\hlkwd{log}\hlstd{(inc_m)} \hlopt{~} \hlstd{educ_years} \hlopt{|} \hlkwd{log}\hlstd{(dist_us_km),} \hlkwc{data} \hlstd{= mexico)}
    \hlkwd{stargazer}\hlstd{(ols, first_stage, second_stage,} \hlkwc{type} \hlstd{=} \hlstr{"text"}\hlstd{)}
\end{alltt}
\begin{verbatim}
## 
## ==================================================================
##                                        Dependent variable:        
##                                 ----------------------------------
##                                 log(inc_m) educ_years  log(inc_m) 
##                                    OLS        OLS     instrumental
##                                                         variable  
##                                    (1)        (2)         (3)     
## ------------------------------------------------------------------
## educ_years                       0.183***               0.453***  
##                                  (0.007)                (0.044)   
##                                                                   
## log(dist_us_km)                            -0.424***              
##                                             (0.052)               
##                                                                   
## Constant                         6.485***   9.738***    4.589***  
##                                  (0.047)    (0.332)     (0.309)   
##                                                                   
## ------------------------------------------------------------------
## Observations                      1,153      1,153       1,153    
## R2                                0.400      0.055       -0.465   
## Adjusted R2                       0.399      0.055       -0.466   
## Residual Std. Error (df = 1151)   0.304      1.317       0.475    
## F Statistic (df = 1; 1151)      767.224*** 67.597***              
## ==================================================================
## Note:                                  *p<0.1; **p<0.05; ***p<0.01
\end{verbatim}
\begin{alltt}
    \hlcom{# part g}
    \hlstd{first_stage_controls} \hlkwb{<-} \hlkwd{lm}\hlstd{(educ_years} \hlopt{~} \hlkwd{log}\hlstd{(dist_us_km)} \hlopt{+} \hlkwd{log}\hlstd{(sales_hotel)} \hlopt{+}
                                                \hlstd{logtemp} \hlopt{+} \hlstd{logprecip} \hlopt{+} \hlstd{ind_lang, mexico)}
    \hlstd{reduced_form} \hlkwb{<-} \hlkwd{lm}\hlstd{(}\hlkwd{log}\hlstd{(inc_m)} \hlopt{~} \hlkwd{log}\hlstd{(dist_us_km), mexico)}
    \hlstd{reduced_form_controls} \hlkwb{<-} \hlkwd{lm}\hlstd{(}\hlkwd{log}\hlstd{(inc_m)} \hlopt{~} \hlkwd{log}\hlstd{(dist_us_km)} \hlopt{+} \hlkwd{log}\hlstd{(sales_hotel)} \hlopt{+}
                                                \hlstd{logtemp} \hlopt{+} \hlstd{logprecip} \hlopt{+} \hlstd{ind_lang, mexico)}
    \hlcom{#stargazer(first_stage, first_stage_controls, reduced_form, }
    \hlcom{#            reduced_form_controls, type = "text")}
\end{alltt}
\end{kframe}
\end{knitrout}

\end{document}
